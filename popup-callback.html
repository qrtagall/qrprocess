<!DOCTYPE html>
<html>
<head>
  <title>QRTagAll - Claim Finalized</title>
<script>
  const urlParams = new URLSearchParams(window.location.search);
  const id = urlParams.get("id");
  const claimed = urlParams.get("claimed");

  console.log("🧾 ID parsed in popup:", id);
  console.log("🔍 opener exists?", !!window.opener);

  if (id && claimed && window.opener) {
    window.opener.postMessage({ claimed: true, id }, "*");
    console.log("📤 postMessage sent to parent");
  } else {
    console.warn("❌ Cannot post message. Either ID missing or opener unavailable.");
  }

  setTimeout(() => {
    window.close(); // Close popup after message
  }, 800);
</script>



    // Optionally close this window after short delay
    setTimeout(() => window.close(), 1000);
  </script>
</head>
<body>
  <p>✅ QR Claimed. You can close this window.</p>
  <script>
    // auto-close in 1 second, fallback after 3 seconds
    setTimeout(() => {
      try {
        window.close();
      } catch (e) {}
    }, 1000);
    setTimeout(() => {
      document.body.innerHTML += "<p style='font-size:12px; color:gray'>(If not closed, please close manually..)</p>";
    }, 3000);
  </script>
</body>

</html>
