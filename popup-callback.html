<!DOCTYPE html>
<html>
<head>
  <title>QRTagAll - Claim Finalized</title>
<script>
  const id = new URLSearchParams(window.location.search).get("id");
  console.log("ðŸ§¾ ID parsed in popup:", id);

  // âœ… 1. Try postMessage (for parent window)
  if (window.opener) {
    console.log("ðŸ“¤ Sending message to opener via postMessage...");
    window.opener.postMessage({ id, claimed: true }, "*");
  } else {
    console.warn("âš ï¸ window.opener not available");
  }

  // âœ… 2. Also broadcast (fallback for same-origin setups)
  try {
    const channel = new BroadcastChannel("qr_claim_channel");
    channel.postMessage({ id, claimed: true });
    console.log("ðŸ“¢ Sent message via BroadcastChannel");
  } catch (e) {
    console.error("âŒ BroadcastChannel failed:", e);
  }

  // âœ… Close popup after delay
  setTimeout(() => window.close(), 700);
</script>




    // Optionally close this window after short delay
    setTimeout(() => window.close(), 1000);
  </script>
</head>
<body>
  <p>âœ… QR Claimed. You can close this window.</p>
  <script>
    // auto-close in 1 second, fallback after 3 seconds
    setTimeout(() => {
      try {
        window.close();
      } catch (e) {}
    }, 1000);
    setTimeout(() => {
      document.body.innerHTML += "<p style='font-size:12px; color:gray'>(If not closed, please close manually..)</p>";
    }, 3000);
  </script>
</body>

</html>
